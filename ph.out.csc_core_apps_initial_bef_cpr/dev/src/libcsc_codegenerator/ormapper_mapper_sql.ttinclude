<#
// #############################################################
// SQL mapper HEADER
// #############################################################
#>

<# guard = CreateGuard("{0}SQLMAPPER"); #>

<# WriteAutoGeneratedComment(); #>

#ifndef <#= guard #>
#define <#= guard #>

<# WriteInclude($"{TypeName}mapperbase"); #>

#include <libbasardbsql_resultsetref.h>
#include <libbasar_definitions.h>

<# SetNamespaceIn(); #>

class <#= TypeName #>SqlMapper : public <#= TypeName #>MapperBase
{
public:
    <#= TypeName #>SqlMapper(<#= TypeName #>Ptr <#= TypeNameFirstLower #>, const basar::db::sql::ResultsetRef resultSet);
    virtual ~<#= TypeName #>SqlMapper();

protected:
    virtual void doMap();

private:
    <#= TypeName #>SqlMapper(const <#= TypeName #>SqlMapper&);
    <#= TypeName #>SqlMapper& operator=(const <#= TypeName #>SqlMapper&);

    const basar::db::sql::ResultsetRef m_ResultSet;
};

<# SetNamespaceOut(); #>

#endif // <#= guard #>

<# SaveOutput($"{TypeName}sqlmapper.h"); #>





<#
// #############################################################
// SQL mapper SOURCE
// #############################################################
#>

<# WriteAutoGeneratedComment(); #>

<# WriteInclude($"{TypeName}sqlmapper"); #>

<# SetNamespaceIn(); #>

<#= TypeName #>SqlMapper::<#= TypeName #>SqlMapper(<#= TypeName #>Ptr <#= TypeNameFirstLower #>, const basar::db::sql::ResultsetRef resultSet)
: <#= TypeName #>MapperBase(<#= TypeNameFirstLower #>), m_ResultSet(resultSet)
{
}

<#= TypeName #>SqlMapper::~<#= TypeName #>SqlMapper()
{
}

void <#= TypeName #>SqlMapper::doMap()
{
    if (m_ResultSet.isNull())
    {
        throw;
    }

    <#
    PushIndent("    ");
    foreach (var item in RequestOutput) {
        WriteLine($"set{item.Key}(m_ResultSet.get{GetResultsetGetterName(item.Value)}(\"{item.Key.ToLower()}\"));");
    }
    ClearIndent();
    #>
}

<# SetNamespaceOut(); #>

<# SaveOutput($"{TypeName}sqlmapper.cpp"); #>
