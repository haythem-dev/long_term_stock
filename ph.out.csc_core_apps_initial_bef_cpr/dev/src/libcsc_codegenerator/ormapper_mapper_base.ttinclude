<#
// #############################################################
// Base mapper HEADER
// #############################################################
#>

<# guard = CreateGuard("{0}MAPPERBASE"); #>

<# WriteAutoGeneratedComment(); #>

#ifndef <#= guard #>
#define <#= guard #>

<# WriteInclude($"{TypeName}ptr"); #>
#include <libbasar_definitions.h>

<# SetNamespaceIn(); #>

class <#= TypeName #>MapperBase
{
public:
    <#= TypeName #>MapperBase(<#= TypeName #>Ptr <#= TypeNameFirstLower #>);

    void map();

protected:
    virtual ~<#= TypeName #>MapperBase();

    virtual void doMap() = 0;

    <#
    PushIndent("    ");
    foreach (var item in RequestOutput) {
        WriteLine($"void set{item.Key}(const {GetFullBasarType(item.Value)}& {FirstLetterToLower(item.Key)});");
    }
    ClearIndent();
    #>

private:
    <#= TypeName #>Ptr m_<#= TypeName #>;
};

<# SetNamespaceOut(); #>

#endif // <#= guard #>

<# SaveOutput($"{TypeName}mapperbase.h"); #>





<#
// #############################################################
// Base mapper SOURCE
// #############################################################
#>

<# WriteAutoGeneratedComment(); #>

<# WriteInclude($"{TypeName}mapperbase"); #>
<# WriteInclude($"{TypeName}"); #>

<# SetNamespaceIn(); #>

<#= TypeName #>MapperBase::<#= TypeName #>MapperBase(<#= TypeName #>Ptr <#= TypeNameFirstLower #>)
: m_<#= TypeName #>(<#= TypeNameFirstLower #>)
{
}

<#= TypeName #>MapperBase::~<#= TypeName #>MapperBase()
{
}

void <#= TypeName #>MapperBase::map()
{
    doMap();
}

<#
foreach (var item in RequestOutput) {
    WriteLine($"void {TypeName}MapperBase::set{item.Key}(const {GetFullBasarType(item.Value)}& {FirstLetterToLower(item.Key)})");
    WriteLine("{");
    WriteLine($"    m_{TypeName}->m_{item.Key} = {FirstLetterToLower(item.Key)};");
    WriteLine($"    m_{TypeName}->m_{item.Key}.setClean();");
    WriteLine("}");
    WriteLine("");
}
#>
<# SetNamespaceOut(); #>

<# SaveOutput($"{TypeName}mapperbase.cpp"); #>
