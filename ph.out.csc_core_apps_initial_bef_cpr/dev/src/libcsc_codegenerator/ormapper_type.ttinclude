<#
// #############################################################
// Type HEADER
// #############################################################
#>

<# guard = CreateGuard("{0}"); #>

<# WriteAutoGeneratedComment(); #>

#ifndef <#= guard #>
#define <#= guard #>

<# WriteInclude($"i{TypeName}"); #>
<#
foreach (string datatype in RequestOutput.Values.Select(x =>
    {
        var typemap = GetTypeMap(x);
        return typemap?.LibcscType ?? x;
    }).Distinct())
{
    WriteLine($"#include <datatypes/{datatype.ToLower()}.h>");
}
#>

<# SetNamespaceIn(); #>

class <#= TypeName #> : public I<#= TypeName #>
{
    // because of OR mapping
    friend class <#= TypeName #>MapperBase;

public:
    <#= TypeName #>();
    virtual ~<#= TypeName #>();

    <#
    PushIndent("    ");
    foreach (var item in RequestOutput) {
        WriteLine($"virtual {GetFullBasarType(item.Value)} get{item.Key}() const;");
    }
    ClearIndent();
    #>

private:
    <#
    PushIndent("    ");
    foreach (var item in RequestOutput) {
        WriteLine($"{GetFullLibCscType(item.Value)} m_{item.Key};");
    }
    ClearIndent();
    #>
};

<# SetNamespaceOut(); #>

#endif // <#= guard #>

<# SaveOutput($"{TypeName}.h"); #>





<#
// #############################################################
// Type SOURCE
// #############################################################
#>

<# WriteAutoGeneratedComment(); #>

<# WriteInclude($"{TypeName}"); #>

<# SetNamespaceIn(); #>

<#= TypeName #>::<#= TypeName #>()
{
}

<#= TypeName #>::~<#= TypeName #>()
{
}

<#
foreach (var item in RequestOutput)
{
    WriteLine($"{GetFullBasarType(item.Value)} {TypeName}::get{item.Key}() const");
    WriteLine("{");
    WriteLine($"    return m_{item.Key};");
    WriteLine("}");
    WriteLine("");
}
SetNamespaceOut(); #>

<# SaveOutput($"{TypeName}.cpp"); #>





<#
// #############################################################
// Type SMARTPOINTER
// #############################################################
#>

<# guard = CreateGuard("{0}PTR"); #>

<# WriteAutoGeneratedComment(); #>

#ifndef <#= guard #>
#define <#= guard #>

#include <boost/shared_ptr.hpp>

<# SetNamespaceIn(); #>

class <#= TypeName #>;
typedef boost::shared_ptr<<#= TypeName #>> <#= TypeName #>Ptr;

<# SetNamespaceOut(); #>

#endif // <#= guard #>

<# SaveOutput($"{TypeName}ptr.h"); #>
